import { Topic, Subject, Difficulty, type SkillTreeNode, type SkillTreeData } from '../../types';

const nodes: SkillTreeNode[] = [
  // ===================== TIER 0: Foundation Skills =====================
  {
    id: 'basic-derivatives',
    title: 'Basic Derivatives',
    description: 'Power rule, trig derivatives, exponential derivatives',
    prerequisites: [],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_1,
    tier: 0,
    position: { x: 1, y: 0 },
    questions: [
      {
        id: 'bd-1',
        text: 'Find the derivative of $f(x) = x^3$.',
        hints: ['Use the power rule: $\\frac{d}{dx}x^n = nx^{n-1}$'],
        answer: '$f\'(x) = 3x^2$',
        markingGuide: ['Apply power rule'],
        marks: 1,
      },
      {
        id: 'bd-2',
        text: 'Differentiate $y = \\sin(x)$.',
        hints: ['Recall: $\\frac{d}{dx}\\sin(x) = \\cos(x)$'],
        answer: '$\\frac{dy}{dx} = \\cos(x)$',
        markingGuide: ['Standard trig derivative'],
        marks: 1,
      },
    ],
  },
  {
    id: 'basic-functions',
    title: 'Function Basics',
    description: 'Domain, range, function notation, evaluating functions',
    prerequisites: [],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_1,
    tier: 0,
    position: { x: 3, y: 0 },
    questions: [
      {
        id: 'bf-1',
        text: 'If $f(x) = 2x + 3$, find $f(4)$.',
        hints: ['Substitute $x = 4$ into the expression'],
        answer: '$f(4) = 11$',
        markingGuide: ['Correct substitution and evaluation'],
        marks: 1,
      },
    ],
  },
  {
    id: 'basic-probability',
    title: 'Probability Fundamentals',
    description: 'Basic probability rules, sample spaces, complementary events',
    prerequisites: [],
    topic: Topic.PROBABILITY,
    difficulty: Difficulty.STAR_1,
    tier: 0,
    position: { x: 5, y: 0 },
    questions: [
      {
        id: 'bp-1',
        text: 'A fair die is rolled. Find $\\Pr(X > 4)$.',
        hints: ['List outcomes greater than 4: {5, 6}'],
        answer: '$\\Pr(X > 4) = \\frac{2}{6} = \\frac{1}{3}$',
        markingGuide: ['Correct probability'],
        marks: 1,
      },
    ],
  },
  {
    id: 'basic-integration',
    title: 'Basic Integration',
    description: 'Antiderivatives, power rule for integration',
    prerequisites: [],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_1,
    tier: 0,
    position: { x: 7, y: 0 },
    questions: [
      {
        id: 'bi-1',
        text: 'Find $\\int 3x^2 \\, dx$.',
        hints: ['Reverse the power rule'],
        answer: '$x^3 + c$',
        markingGuide: ['Correct antiderivative with constant'],
        marks: 1,
      },
    ],
  },
  {
    id: 'trig-basics',
    title: 'Trigonometric Functions',
    description: 'Unit circle, sin/cos/tan values, basic trig equations',
    prerequisites: [],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_1,
    tier: 0,
    position: { x: 9, y: 0 },
    questions: [
      {
        id: 'tb-1',
        text: 'Find all solutions to $\\cos(x) = \\frac{1}{2}$ for $x \\in [0, 2\\pi]$.',
        hints: ['The base angle is $\\frac{\\pi}{3}$', 'Cosine is positive in Q1 and Q4'],
        answer: '$x = \\frac{\\pi}{3}, \\frac{5\\pi}{3}$',
        markingGuide: ['Both solutions found'],
        marks: 2,
      },
    ],
  },
  {
    id: 'exponential-basics',
    title: 'Exponential & Log Basics',
    description: 'Properties of $e^x$ and $\\log_e(x)$, index laws',
    prerequisites: [],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_1,
    tier: 0,
    position: { x: 11, y: 0 },
    questions: [
      {
        id: 'eb-1',
        text: 'Solve $e^x = 5$ for $x$.',
        hints: ['Take the natural log of both sides'],
        answer: '$x = \\log_e(5)$',
        markingGuide: ['Correct use of logarithm'],
        marks: 1,
      },
    ],
  },
  {
    id: 'polynomial-basics',
    title: 'Polynomial Fundamentals',
    description: 'Factor theorem, polynomial division, roots',
    prerequisites: [],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_1,
    tier: 0,
    position: { x: 13, y: 0 },
    questions: [
      {
        id: 'pb-1',
        text: 'Verify that $x = 2$ is a root of $p(x) = x^3 - 4x$.',
        hints: ['Substitute $x = 2$ and check if $p(2) = 0$'],
        answer: '$p(2) = 8 - 8 = 0$ ✓',
        markingGuide: ['Correct verification'],
        marks: 1,
      },
    ],
  },

  // ===================== TIER 1: Intermediate Skills =====================
  {
    id: 'product-rule',
    title: 'Product Rule',
    description: "Differentiate products of functions: $(uv)' = u'v + uv'$",
    prerequisites: ['basic-derivatives'],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_2,
    tier: 1,
    position: { x: 0, y: 1 },
    questions: [
      {
        id: 'pr-1',
        text: 'Find $\\frac{d}{dx}[x \\cdot \\sin(x)]$.',
        hints: ['Let $u = x$ and $v = \\sin(x)$', "Apply $(uv)' = u'v + uv'$"],
        answer: '$\\sin(x) + x\\cos(x)$',
        markingGuide: ['Identify u and v', 'Apply product rule correctly'],
        marks: 2,
      },
    ],
  },
  {
    id: 'chain-rule',
    title: 'Chain Rule',
    description: "Differentiate composite functions: $\\frac{d}{dx}f(g(x)) = f'(g(x)) \\cdot g'(x)$",
    prerequisites: ['basic-derivatives'],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_2,
    tier: 1,
    position: { x: 2, y: 1 },
    questions: [
      {
        id: 'cr-1',
        text: 'Find $\\frac{d}{dx}(x+1)^{1/2}$.',
        hints: ['Let $u = x + 1$, then differentiate $u^{1/2}$'],
        answer: '$\\frac{1}{2\\sqrt{x+1}}$',
        markingGuide: ['Correct chain rule application'],
        marks: 1,
      },
    ],
  },
  {
    id: 'integration-techniques',
    title: 'Integration Techniques',
    description: "Integration by substitution, $\\int \\frac{f'(x)}{f(x)} dx = \\log_e|f(x)| + c$",
    prerequisites: ['basic-integration', 'exponential-basics'],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_2,
    tier: 1,
    position: { x: 8, y: 1 },
    questions: [
      {
        id: 'it-1',
        text: 'Find $\\int \\frac{2}{2x+1} dx$.',
        hints: ["This is of the form $\\int \\frac{f'(x)}{f(x)} dx$"],
        answer: '$\\log_e(2x+1) + c$',
        markingGuide: ['Recognise form and integrate correctly'],
        marks: 1,
      },
    ],
  },
  {
    id: 'circular-transformations',
    title: 'Transformed Trig Functions',
    description: 'Amplitude, period, phase shift: $a\\cos(bx + c) + d$',
    prerequisites: ['trig-basics', 'basic-functions'],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_2,
    tier: 1,
    position: { x: 6, y: 1 },
    questions: [
      {
        id: 'ct-1',
        text: 'State the range of $f(x) = 2\\cos(x) + 3$.',
        hints: ['$\\cos(x)$ ranges from $-1$ to $1$', 'Scale by 2 then shift up by 3'],
        answer: '$[1, 5]$',
        markingGuide: ['Correct range'],
        marks: 1,
      },
    ],
  },
  {
    id: 'discrete-distributions',
    title: 'Discrete Probability Distributions',
    description: 'PMF tables, expected value $E(X)$, variance, sum of probabilities = 1',
    prerequisites: ['basic-probability'],
    topic: Topic.PROBABILITY,
    difficulty: Difficulty.STAR_2,
    tier: 1,
    position: { x: 4, y: 1 },
    questions: [
      {
        id: 'dd-1',
        text: 'A discrete RV $X$ has $\\Pr(X=0) = 0.3$, $\\Pr(X=1) = 0.5$, $\\Pr(X=2) = 0.2$. Find $E(X)$.',
        hints: ['$E(X) = \\sum x \\cdot \\Pr(X=x)$'],
        answer: '$E(X) = 0(0.3) + 1(0.5) + 2(0.2) = 0.9$',
        markingGuide: ['Correct calculation'],
        marks: 1,
      },
    ],
  },
  {
    id: 'exponential-equations',
    title: 'Exponential Equations',
    description: 'Solving equations involving $e^x$, substitution techniques',
    prerequisites: ['exponential-basics'],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_2,
    tier: 1,
    position: { x: 12, y: 1 },
    questions: [
      {
        id: 'ee-1',
        text: 'Solve $e^{2x} - 5e^x + 6 = 0$.',
        hints: ['Let $u = e^x$ to form a quadratic'],
        answer: '$x = \\log_e(2)$ or $x = \\log_e(3)$',
        markingGuide: ['Correct substitution', 'Both solutions'],
        marks: 2,
      },
    ],
  },
  {
    id: 'polynomial-factoring',
    title: 'Polynomial Factorisation',
    description: 'Long division, factor theorem, expressing in factored form',
    prerequisites: ['polynomial-basics'],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_2,
    tier: 1,
    position: { x: 14, y: 1 },
    questions: [
      {
        id: 'pf-1',
        text: 'Given that $x = 3$ is a root of $p(x) = x^3 - 7x + 6$, factorise $p(x)$ completely.',
        hints: ['Use $(x-3)$ as a factor', 'Perform polynomial division'],
        answer: '$(x-3)(x-1)(x+2)$',
        markingGuide: ['Correct factorisation'],
        marks: 2,
      },
    ],
  },

  // ===================== TIER 2: Advanced Skills =====================
  {
    id: 'tangent-gradient',
    title: 'Tangent Lines & Gradients',
    description: 'Finding gradient at a point, tangent line equations',
    prerequisites: ['chain-rule'],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_3,
    tier: 2,
    position: { x: 2, y: 2 },
    questions: [
      {
        id: 'tg-1',
        text: 'Find the gradient of the tangent to $y = \\sqrt{x+4}$ at $x = 5$.',
        hints: ['Differentiate first, then substitute'],
        answer: '$\\frac{1}{6}$',
        markingGuide: ['Differentiate correctly', 'Evaluate at point'],
        marks: 2,
      },
    ],
  },
  {
    id: 'antidiff-initial-condition',
    title: 'Antidifferentiation with Conditions',
    description: "Finding $f(x)$ given $f'(x)$ and an initial condition",
    prerequisites: ['integration-techniques'],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_3,
    tier: 2,
    position: { x: 8, y: 2 },
    questions: [
      {
        id: 'aic-1',
        text: "Given $f'(x) = \\frac{1}{x+2}$ and $f(0) = 1$, find $f(x)$.",
        hints: ["Integrate $f'(x)$", 'Use the initial condition to find $c$'],
        answer: '$f(x) = \\log_e(x+2) - \\log_e(2) + 1$',
        markingGuide: ['Correct integration', 'Apply initial condition'],
        marks: 2,
      },
    ],
  },
  {
    id: 'binomial-distribution',
    title: 'Binomial Distribution',
    description: '$X \\sim \\text{Bi}(n,p)$: probability, mean, variance',
    prerequisites: ['discrete-distributions'],
    topic: Topic.PROBABILITY,
    difficulty: Difficulty.STAR_3,
    tier: 2,
    position: { x: 4, y: 2 },
    questions: [
      {
        id: 'bin-1',
        text: 'If $X \\sim \\text{Bi}(5, 0.3)$, find $\\text{Var}(X)$.',
        hints: ['$\\text{Var}(X) = np(1-p)$'],
        answer: '$\\text{Var}(X) = 5(0.3)(0.7) = 1.05$',
        markingGuide: ['Correct formula and calculation'],
        marks: 1,
      },
    ],
  },
  {
    id: 'trig-equations-advanced',
    title: 'Advanced Trig Equations',
    description: 'Solving $a\\cos(bx) + c = 0$ over intervals',
    prerequisites: ['circular-transformations'],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_3,
    tier: 2,
    position: { x: 6, y: 2 },
    questions: [
      {
        id: 'tea-1',
        text: 'Solve $2\\cos(2x) + 1 = 0$ for $x \\in [0, 2\\pi]$.',
        hints: ['Rearrange to $\\cos(2x) = -\\frac{1}{2}$', 'Find all solutions for $2x$ first'],
        answer: '$x = \\frac{\\pi}{3}, \\frac{2\\pi}{3}, \\frac{4\\pi}{3}, \\frac{5\\pi}{3}$',
        markingGuide: ['All four solutions'],
        marks: 3,
      },
    ],
  },
  {
    id: 'continuous-probability',
    title: 'Continuous Probability',
    description: 'PDF properties, $\\int f(x) dx = 1$, finding probabilities via integration',
    prerequisites: ['basic-probability', 'basic-integration'],
    topic: Topic.PROBABILITY,
    difficulty: Difficulty.STAR_3,
    tier: 2,
    position: { x: 10, y: 2 },
    questions: [
      {
        id: 'cp-1',
        text: 'A continuous RV has PDF $f(x) = 2x$ for $0 \\le x \\le 1$. Find $\\Pr(X > 0.5)$.',
        hints: ['Integrate the PDF from 0.5 to 1'],
        answer: '$\\Pr(X > 0.5) = \\int_{0.5}^{1} 2x\\,dx = [x^2]_{0.5}^{1} = 0.75$',
        markingGuide: ['Correct integration and bounds'],
        marks: 2,
      },
    ],
  },
  {
    id: 'stationary-points',
    title: 'Stationary Points & Turning Points',
    description: 'Finding and classifying stationary points, inverse functions',
    prerequisites: ['basic-derivatives', 'exponential-equations'],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_3,
    tier: 2,
    position: { x: 12, y: 2 },
    questions: [
      {
        id: 'sp-1',
        text: 'Find the stationary point of $f(x) = e^{2x} - 4e^x$.',
        hints: ["Set $f'(x) = 0$", 'Factor out $e^x$'],
        answer: '$x = \\log_e(2)$, minimum',
        markingGuide: ['Correct derivative', 'Solve for x'],
        marks: 2,
      },
    ],
  },
  {
    id: 'polynomial-graphs',
    title: 'Polynomial Graphs',
    description: 'Intercepts, repeated roots, stationary points of inflection',
    prerequisites: ['polynomial-factoring', 'basic-derivatives'],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_3,
    tier: 2,
    position: { x: 14, y: 2 },
    questions: [
      {
        id: 'pg-1',
        text: 'Sketch $y = (x+1)^2(x-3)$, labelling all intercepts.',
        hints: ['Repeated root at $x = -1$', 'Single root at $x = 3$'],
        answer: 'Touch at $(-1, 0)$, cut at $(3, 0)$, y-int $(0, -3)$',
        markingGuide: ['All intercepts', 'Correct shape'],
        marks: 3,
      },
    ],
  },

  // ===================== TIER 3: Exam Question Nodes =====================
  {
    id: 'exam-q1a',
    title: 'Exam Q1a: Product Rule',
    description: 'Let $y = x^2\\cos(x)$. Find $\\frac{dy}{dx}$.',
    prerequisites: ['product-rule'],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_2,
    tier: 3,
    position: { x: 0, y: 3 },
    isExamQuestion: true,
    examRef: { examId: 'mm-2025-exam1', year: 2025, subject: Subject.METHODS, questionNumber: 'Q1a', marks: 1 },
    questions: [
      {
        id: 'eq-1a',
        text: 'Let $y = x^2 \\cos(x)$. Find $\\frac{dy}{dx}$.',
        hints: ['Apply product rule with $u = x^2$ and $v = \\cos(x)$'],
        answer: '$2x\\cos(x) - x^2\\sin(x)$',
        markingGuide: ['Apply product rule: $u=x^2, v=\\cos(x)$', "$u'=2x, v'=-\\sin(x)$", '$\\frac{dy}{dx} = 2x\\cos(x) - x^2\\sin(x)$'],
        marks: 1,
      },
    ],
  },
  {
    id: 'exam-q1b',
    title: 'Exam Q1b: Tangent Gradient',
    description: 'Find the gradient of tangent to $y = 6\\sqrt{x+1} + 5$ at $x = 8$.',
    prerequisites: ['tangent-gradient'],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_3,
    tier: 3,
    position: { x: 2, y: 3 },
    isExamQuestion: true,
    examRef: { examId: 'mm-2025-exam1', year: 2025, subject: Subject.METHODS, questionNumber: 'Q1b', marks: 2 },
    questions: [
      {
        id: 'eq-1b',
        text: 'Let $f(x) = 6\\sqrt{x+1} + 5$. Find the gradient of the tangent to $y=f(x)$ at $x=8$.',
        hints: ['Rewrite as $f(x) = 6(x+1)^{1/2} + 5$', 'Differentiate using chain rule', 'Evaluate at $x = 8$'],
        answer: "$f'(8) = 1$",
        markingGuide: ["$f'(x) = \\frac{3}{\\sqrt{x+1}}$", "$f'(8) = \\frac{3}{3} = 1$"],
        marks: 2,
      },
    ],
  },
  {
    id: 'exam-q2',
    title: 'Exam Q2: Antidifferentiation',
    description: "Find $g(x)$ given $g'(x) = \\frac{1}{2x+3}$ and $g(1) = 0$.",
    prerequisites: ['antidiff-initial-condition'],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_3,
    tier: 3,
    position: { x: 8, y: 3 },
    isExamQuestion: true,
    examRef: { examId: 'mm-2025-exam1', year: 2025, subject: Subject.METHODS, questionNumber: 'Q2', marks: 2 },
    questions: [
      {
        id: 'eq-2',
        text: "Let $g(x)$ be defined for $x > -\\frac{3}{2}$ with $g'(x) = \\frac{1}{2x+3}$ and $g(1) = 0$. Find $g(x)$.",
        hints: ['Integrate $\\frac{1}{2x+3}$', 'Use initial condition $g(1) = 0$ to find $c$'],
        answer: '$g(x) = \\frac{1}{2}\\log_e(2x+3) - \\frac{1}{2}\\log_e(5)$',
        markingGuide: ['Correct integration', 'Apply initial condition'],
        marks: 2,
      },
    ],
  },
  {
    id: 'exam-q3',
    title: 'Exam Q3: Trig Function Analysis',
    description: 'Analyse $f(x) = 2\\cos(2x) + 1$: range, solve, sketch.',
    prerequisites: ['trig-equations-advanced'],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_4,
    tier: 3,
    position: { x: 6, y: 3 },
    isExamQuestion: true,
    examRef: { examId: 'mm-2025-exam1', year: 2025, subject: Subject.METHODS, questionNumber: 'Q3', marks: 6 },
    questions: [
      {
        id: 'eq-3',
        text: 'Let $f: [0, 2\\pi] \\to R, f(x) = 2\\cos(2x) + 1$.\na. State the range of $f$.\nb. Solve $f(x) = 0$.\nc. Sketch for $x \\in [\\frac{\\pi}{2}, \\frac{3\\pi}{2}]$.',
        hints: ['Range: scale and shift the base range $[-1, 1]$', 'Solve $\\cos(2x) = -\\frac{1}{2}$'],
        answer: 'a. $[-1, 3]$ b. $x = \\frac{\\pi}{3}, \\frac{2\\pi}{3}, \\frac{4\\pi}{3}, \\frac{5\\pi}{3}$',
        markingGuide: ['Range correct', 'All four solutions', 'Graph shape and endpoints'],
        marks: 6,
      },
    ],
  },
  {
    id: 'exam-q4',
    title: 'Exam Q4: Discrete Distribution',
    description: 'PMF with parameter $k$, find $\\Pr(X>1)$ and $E(X)$.',
    prerequisites: ['discrete-distributions'],
    topic: Topic.PROBABILITY,
    difficulty: Difficulty.STAR_3,
    tier: 3,
    position: { x: 4, y: 3 },
    isExamQuestion: true,
    examRef: { examId: 'mm-2025-exam1', year: 2025, subject: Subject.METHODS, questionNumber: 'Q4', marks: 4 },
    questions: [
      {
        id: 'eq-4',
        text: 'PMF: $\\Pr(X=x)$: $\\frac{4}{k}, \\frac{2k}{75}, \\frac{k}{75}, \\frac{2}{k}$ for $x = 0,1,2,3$.\na. Show $k = 10$ or $k = 15$.\nb. With $k=15$, find $\\Pr(X>1)$ and $E(X)$.',
        hints: ['Sum of all probabilities = 1', 'Form a quadratic in $k$'],
        answer: 'a. $(k-10)(k-15)=0$ b. $\\Pr(X>1) = \\frac{1}{3}$, $E(X) = 1.2$',
        markingGuide: ['Quadratic equation', 'Both values of k', 'Correct probability and expectation'],
        marks: 4,
      },
    ],
  },
  {
    id: 'exam-q5',
    title: 'Exam Q5: Exponential Equation & Inverse',
    description: 'Solve $e^{2x} - 8e^x + 7 = 0$; find domain restriction for inverse.',
    prerequisites: ['exponential-equations', 'stationary-points'],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_4,
    tier: 3,
    position: { x: 12, y: 3 },
    isExamQuestion: true,
    examRef: { examId: 'mm-2025-exam1', year: 2025, subject: Subject.METHODS, questionNumber: 'Q5', marks: 4 },
    questions: [
      {
        id: 'eq-5',
        text: 'a. Solve $e^{2x} - 8e^x + 7 = 0$.\nb. Find the largest $a$ such that $g$ restricted to $(-\\infty, a]$ has an inverse.',
        hints: ['Substitute $u = e^x$', 'Find the turning point for part b'],
        answer: 'a. $x = 0, \\log_e(7)$ b. $a = \\log_e(4)$',
        markingGuide: ['Substitution', 'Both solutions', 'Turning point gives max a'],
        marks: 4,
      },
    ],
  },
  {
    id: 'exam-q6',
    title: 'Exam Q6: Binomial Distribution',
    description: '$X \\sim \\text{Bi}(6, \\frac{1}{4})$: variance and tail probability.',
    prerequisites: ['binomial-distribution'],
    topic: Topic.PROBABILITY,
    difficulty: Difficulty.STAR_3,
    tier: 3,
    position: { x: 4, y: 4 },
    isExamQuestion: true,
    examRef: { examId: 'mm-2025-exam1', year: 2025, subject: Subject.METHODS, questionNumber: 'Q6', marks: 3 },
    questions: [
      {
        id: 'eq-6',
        text: 'Let $X \\sim \\text{Bi}(6, \\frac{1}{4})$.\na. Find $\\text{Var}(X)$.\nb. Find $\\Pr(X \\ge 5)$ in the form $\\frac{a}{2^b}$.',
        hints: ['$\\text{Var} = np(1-p)$', 'Calculate $\\Pr(5) + \\Pr(6)$ using binomial formula'],
        answer: 'a. $\\frac{9}{8}$ b. $\\frac{19}{2^{12}}$',
        markingGuide: ['Correct variance', 'Binomial probabilities', 'Simplified form'],
        marks: 3,
      },
    ],
  },
  {
    id: 'exam-q7',
    title: 'Exam Q7: Cubic & Product Functions',
    description: 'Factorise $x^3 - x^2 - 16x - 20$, analyse $f(x)g(x)$.',
    prerequisites: ['polynomial-graphs'],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_4,
    tier: 3,
    position: { x: 14, y: 3 },
    isExamQuestion: true,
    examRef: { examId: 'mm-2025-exam1', year: 2025, subject: Subject.METHODS, questionNumber: 'Q7', marks: 6 },
    questions: [
      {
        id: 'eq-7',
        text: 'Let $f(x) = x^3 - x^2 - 16x - 20$.\na. Verify $x = 5$ is a root.\nb. Express as $(x+d)^2(x-5)$.\nc. Find intercepts.\nd. For $g(x) = x+2$, find stationary point of inflection of $f(x)g(x)$ and solve $f(x)g(x) \\ge 0$.',
        hints: ['Factor theorem', 'Long division after removing $(x-5)$'],
        answer: '$(x+2)^2(x-5)$, inflection at $(-2,0)$, $f(x)g(x) \\ge 0$ when $x \\ge 5$ or $x = -2$',
        markingGuide: ['Verification', 'Correct factorisation', 'All intercepts', 'Inflection point', 'Inequality solution'],
        marks: 6,
      },
    ],
  },
  {
    id: 'exam-q8',
    title: 'Exam Q8: Continuous PDF',
    description: 'PDF analysis, finding $k$ for tail probability, transformation integral.',
    prerequisites: ['continuous-probability', 'integration-techniques'],
    topic: Topic.PROBABILITY,
    difficulty: Difficulty.STAR_4,
    tier: 3,
    position: { x: 10, y: 3 },
    isExamQuestion: true,
    examRef: { examId: 'mm-2025-exam1', year: 2025, subject: Subject.METHODS, questionNumber: 'Q8', marks: 5 },
    questions: [
      {
        id: 'eq-8',
        text: 'PDF: $f(x) = \\frac{3}{8}(4-3x)$ for $0 \\le x \\le \\frac{4}{3}$.\na. Find $k$ such that $\\Pr(X > k) = \\frac{9}{16}$.\nb. Find $\\int_0^{4/3} h(x) dx$ where $h(x) = mf(x) + n$.',
        hints: ['Set up and solve the integral equation', 'Use linearity of integration'],
        answer: 'a. $k = \\frac{1}{3}$ b. $m + \\frac{4n}{3}$',
        markingGuide: ['Correct integral setup', 'Solve for k', 'Linearity of integration'],
        marks: 5,
      },
    ],
  },
  {
    id: 'exam-q9',
    title: 'Exam Q9: Function Intersection',
    description: 'Find intersections of $f(x) = \\frac{w^2}{(x-1)^2}$ and $g(x) = (x-w)^2$.',
    prerequisites: ['exponential-equations', 'polynomial-graphs', 'stationary-points'],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_5,
    tier: 4,
    position: { x: 7, y: 4 },
    isExamQuestion: true,
    examRef: { examId: 'mm-2025-exam1', year: 2025, subject: Subject.METHODS, questionNumber: 'Q9', marks: 7 },
    questions: [
      {
        id: 'eq-9',
        text: 'Consider $f(x) = \\frac{w^2}{(x-1)^2}$ and $g(x) = (x-w)^2$.\na. If $w = -3$, find the four solutions to $f(x) = g(x)$.\nb. Find positive $w$ for exactly three solutions.',
        hints: ['Take square root of both sides to get $(x-1)(x-w) = \\pm w$', 'Vertex of parabola touches the line'],
        answer: 'a. $x = -1 \\pm \\sqrt{7}, 0, -2$ b. $w = 3 \\pm 2\\sqrt{2}$',
        markingGuide: ['Square root approach', 'Two quadratics', 'Vertex condition for 3 solutions'],
        marks: 7,
      },
    ],
  },
];

export const MM_2025_EXAM1_TREE: SkillTreeData = {
  id: 'mm-2025-exam1',
  title: 'Methods 2025 Exam 1',
  description: 'VCE Mathematical Methods 2025 — Exam 1 (Technology Free)',
  subject: Subject.METHODS,
  year: 2025,
  nodes,
  totalMarks: 40,
};
