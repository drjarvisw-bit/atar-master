import { Topic, Subject, Difficulty, type SkillTreeNode, type SkillTreeData } from '../../types';

const nodes: SkillTreeNode[] = [
  // ===================== TIER 0: Foundation Skills =====================
  {
    id: 'mm21e1-basic-derivatives',
    title: 'Basic Derivatives',
    description: 'Power rule, exponential, chain rule basics',
    prerequisites: [],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_1,
    tier: 0,
    position: { x: 1, y: 0 },
    questions: [
      {
        id: 'mm21e1-bd-1',
        text: 'Find the derivative of $y = e^{-3x}$.',
        hints: ['Apply chain rule: $\\frac{d}{dx}e^{ax} = ae^{ax}$'],
        answer: '$\\frac{dy}{dx} = -3e^{-3x}$',
        markingGuide: ['Correct chain rule application'],
        marks: 1,
      },
      {
        id: 'mm21e1-bd-2',
        text: 'Differentiate $y = x^4$.',
        hints: ['Power rule: $\\frac{d}{dx}x^n = nx^{n-1}$'],
        answer: "$\\frac{dy}{dx} = 4x^3$",
        markingGuide: ['Correct power rule'],
        marks: 1,
      },
    ],
  },
  {
    id: 'mm21e1-basic-functions',
    title: 'Function Basics',
    description: 'Domain, range, quadratics, function evaluation',
    prerequisites: [],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_1,
    tier: 0,
    position: { x: 3, y: 0 },
    questions: [
      {
        id: 'mm21e1-bf-1',
        text: 'Find the x-intercepts of $f(x) = x^2 - 4$.',
        hints: ['Set $f(x) = 0$ and factorise'],
        answer: '$x^2 - 4 = 0 \\implies x = \\pm 2$. Intercepts: $(-2, 0)$ and $(2, 0)$.',
        markingGuide: ['Both intercepts found'],
        marks: 1,
      },
    ],
  },
  {
    id: 'mm21e1-basic-probability',
    title: 'Probability Fundamentals',
    description: 'Basic probability rules, counting, complementary events',
    prerequisites: [],
    topic: Topic.PROBABILITY,
    difficulty: Difficulty.STAR_1,
    tier: 0,
    position: { x: 5, y: 0 },
    questions: [
      {
        id: 'mm21e1-bp-1',
        text: 'A box has 20 doughnuts: $\\frac{1}{2}$ have custard, $\\frac{7}{10}$ are not glazed, $\\frac{1}{10}$ are glazed with custard. How many are not glazed with custard?',
        hints: ['Custard = 10 total, glazed with custard = 2', 'Not glazed with custard = custard total - glazed with custard'],
        answer: '$10 - 2 = 8$ doughnuts. Probability = $\\frac{8}{20} = \\frac{2}{5}$.',
        markingGuide: ['Correct count', 'Correct probability'],
        marks: 1,
      },
    ],
  },
  {
    id: 'mm21e1-basic-integration',
    title: 'Basic Integration',
    description: 'Antiderivatives, power rule for integration, finding constants',
    prerequisites: [],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_1,
    tier: 0,
    position: { x: 7, y: 0 },
    questions: [
      {
        id: 'mm21e1-bi-1',
        text: 'Find $\\int (x^3 + x) \\, dx$.',
        hints: ['Integrate each term using the power rule'],
        answer: '$\\frac{x^4}{4} + \\frac{x^2}{2} + c$',
        markingGuide: ['Correct antiderivative with constant'],
        marks: 1,
      },
    ],
  },
  {
    id: 'mm21e1-trig-basics',
    title: 'Trigonometric Functions',
    description: 'Sine and cosine graphs, period, amplitude, range',
    prerequisites: [],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_1,
    tier: 0,
    position: { x: 9, y: 0 },
    questions: [
      {
        id: 'mm21e1-tb-1',
        text: 'State the range and period of $g(x) = 2\\sin(2x)$.',
        hints: ['Amplitude is 2, so range is $[-2, 2]$', 'Period = $\\frac{2\\pi}{n}$ where $n$ is the coefficient of $x$'],
        answer: 'Range: $[-2, 2]$. Period: $\\frac{2\\pi}{2} = \\pi$.',
        markingGuide: ['Correct range', 'Correct period'],
        marks: 1,
      },
    ],
  },
  {
    id: 'mm21e1-rational-basics',
    title: 'Rational Functions',
    description: 'Asymptotes, intercepts, and shape of $\\frac{a}{x-h} + k$',
    prerequisites: [],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_1,
    tier: 0,
    position: { x: 11, y: 0 },
    questions: [
      {
        id: 'mm21e1-rb-1',
        text: 'State the asymptotes of $y = 1 - \\frac{2}{x-2}$.',
        hints: ['Vertical asymptote where denominator is zero', 'Horizontal asymptote is the constant term as $x \\to \\infty$'],
        answer: 'VA: $x = 2$. HA: $y = 1$.',
        markingGuide: ['Both asymptotes correct'],
        marks: 1,
      },
    ],
  },
  {
    id: 'mm21e1-circle-geometry',
    title: 'Unit Circle & Tangent Lines',
    description: 'Unit circle $x^2 + y^2 = 1$, tangent line equations, coordinates on the circle',
    prerequisites: [],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_1,
    tier: 0,
    position: { x: 13, y: 0 },
    questions: [
      {
        id: 'mm21e1-cg-1',
        text: 'A point $P$ on the unit circle has $\\cos\\theta = \\frac{1}{2}$ with $\\theta \\in [0, \\frac{\\pi}{2}]$. Find the coordinates of $P$.',
        hints: ['$\\theta = \\frac{\\pi}{3}$', '$P = (\\cos\\frac{\\pi}{3}, \\sin\\frac{\\pi}{3})$'],
        answer: '$P = (\\frac{1}{2}, \\frac{\\sqrt{3}}{2})$',
        markingGuide: ['Correct coordinates'],
        marks: 1,
      },
    ],
  },

  // ===================== TIER 1: Intermediate Skills =====================
  {
    id: 'mm21e1-product-rule',
    title: 'Product Rule',
    description: "Differentiate products of functions: $(uv)' = u'v + uv'$",
    prerequisites: ['mm21e1-basic-derivatives'],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_2,
    tier: 1,
    position: { x: 0, y: 1 },
    questions: [
      {
        id: 'mm21e1-pr-1',
        text: 'Find $f\'(x)$ where $f(x) = x\\sqrt{2x+1}$.',
        hints: ['Let $u = x$, $v = (2x+1)^{1/2}$', 'Simplify: $\\frac{3x+1}{\\sqrt{2x+1}}$'],
        answer: "$f'(x) = \\sqrt{2x+1} + \\frac{x}{\\sqrt{2x+1}} = \\frac{3x+1}{\\sqrt{2x+1}}$",
        markingGuide: ['Correct product rule', 'Simplified form'],
        marks: 2,
      },
    ],
  },
  {
    id: 'mm21e1-chain-rule',
    title: 'Chain Rule',
    description: "Differentiate composites: $\\frac{d}{dx}f(g(x)) = f'(g(x)) \\cdot g'(x)$",
    prerequisites: ['mm21e1-basic-derivatives'],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_2,
    tier: 1,
    position: { x: 2, y: 1 },
    questions: [
      {
        id: 'mm21e1-cr-1',
        text: 'Differentiate $y = 2e^{-3x}$.',
        hints: ['Chain rule with $u = -3x$'],
        answer: '$\\frac{dy}{dx} = 2 \\times (-3)e^{-3x} = -6e^{-3x}$',
        markingGuide: ['Correct chain rule application'],
        marks: 1,
      },
    ],
  },
  {
    id: 'mm21e1-conditional-probability',
    title: 'Conditional Probability',
    description: '$\\Pr(A|B)$, Bayes\' theorem, two-way tables',
    prerequisites: ['mm21e1-basic-probability'],
    topic: Topic.PROBABILITY,
    difficulty: Difficulty.STAR_2,
    tier: 1,
    position: { x: 4, y: 1 },
    questions: [
      {
        id: 'mm21e1-cp-1',
        text: 'Box A has $g$ glazed out of 10, Box B has $6-g$ glazed out of 10. A box is chosen at random then a doughnut from that box. Find $\\Pr(B | \\text{glazed})$.',
        hints: ['$\\Pr(\\text{glazed}) = \\frac{1}{2} \\cdot \\frac{g}{10} + \\frac{1}{2} \\cdot \\frac{6-g}{10} = \\frac{3}{10}$', 'Apply Bayes\' theorem'],
        answer: '$\\Pr(B|\\text{glazed}) = \\frac{\\frac{1}{2} \\cdot \\frac{6-g}{10}}{\\frac{3}{10}} = \\frac{6-g}{6}$',
        markingGuide: ['Correct total probability', 'Correct Bayes application'],
        marks: 2,
      },
    ],
  },
  {
    id: 'mm21e1-trig-equations',
    title: 'Solving Trig Equations',
    description: 'Solving $\\sin(nx) = k$ for general solutions',
    prerequisites: ['mm21e1-trig-basics'],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_2,
    tier: 1,
    position: { x: 6, y: 1 },
    questions: [
      {
        id: 'mm21e1-te-1',
        text: 'Solve $\\sin(2x) = \\frac{\\sqrt{3}}{2}$ for $x \\in R$.',
        hints: ['Base angle for $\\sin\\theta = \\frac{\\sqrt{3}}{2}$ is $\\frac{\\pi}{3}$', 'General solution for $\\sin(2x) = \\sin(\\frac{\\pi}{3})$'],
        answer: '$x = \\frac{\\pi}{6} + k\\pi$ or $x = \\frac{\\pi}{3} + k\\pi$, $k \\in \\mathbb{Z}$',
        markingGuide: ['Both families of solutions', 'General form with $k$'],
        marks: 3,
      },
    ],
  },
  {
    id: 'mm21e1-antidiff-conditions',
    title: 'Antidifferentiation with Conditions',
    description: "Finding $f(x)$ given $f'(x)$ and a point on the curve",
    prerequisites: ['mm21e1-basic-integration'],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_2,
    tier: 1,
    position: { x: 8, y: 1 },
    questions: [
      {
        id: 'mm21e1-ac-1',
        text: "Given $f'(x) = x^3 + x$ and $f(1) = 2$, find $f(x)$.",
        hints: ['Integrate: $f(x) = \\frac{x^4}{4} + \\frac{x^2}{2} + c$', 'Use $f(1) = 2$ to find $c$'],
        answer: '$f(x) = \\frac{x^4}{4} + \\frac{x^2}{2} + \\frac{5}{4}$',
        markingGuide: ['Correct antiderivative', 'Correct constant from initial condition'],
        marks: 2,
      },
    ],
  },
  {
    id: 'mm21e1-rational-graphing',
    title: 'Rational Function Graphing',
    description: 'Sketching with asymptotes, intercepts, and solving inequalities',
    prerequisites: ['mm21e1-rational-basics', 'mm21e1-basic-functions'],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_2,
    tier: 1,
    position: { x: 10, y: 1 },
    questions: [
      {
        id: 'mm21e1-rg-1',
        text: 'Find the intercepts of $y = 1 - \\frac{2}{x-2}$.',
        hints: ['y-int: set $x = 0$', 'x-int: set $y = 0$'],
        answer: 'y-int: $(0, 2)$. x-int: $1 = \\frac{2}{x-2}$, so $x = 4$. Point $(4, 0)$.',
        markingGuide: ['Both intercepts correct'],
        marks: 2,
      },
    ],
  },
  {
    id: 'mm21e1-transformations',
    title: 'Function Transformations',
    description: 'Dilations from axes, translations, effect on rules and intercepts',
    prerequisites: ['mm21e1-basic-functions'],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_2,
    tier: 1,
    position: { x: 12, y: 1 },
    questions: [
      {
        id: 'mm21e1-tf-1',
        text: 'Apply dilation by factor $\\frac{1}{2}$ from the y-axis then translation 2 units right to $f(x) = x^2 - 4$. State the new rule.',
        hints: ['Dilation: replace $x$ with $2x$: $f(2x) = 4x^2 - 4$', 'Translation: replace $x$ with $x-2$'],
        answer: '$h(x) = 4(x-2)^2 - 4$',
        markingGuide: ['Correct dilation', 'Correct translation', 'Correct final rule'],
        marks: 2,
      },
    ],
  },

  // ===================== TIER 2: Advanced Skills =====================
  {
    id: 'mm21e1-derivative-analysis',
    title: 'Derivative Analysis & Stationary Points',
    description: "Using $f'(x)$ and $f''(x)$ to classify stationary points",
    prerequisites: ['mm21e1-product-rule', 'mm21e1-chain-rule'],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_3,
    tier: 2,
    position: { x: 1, y: 2 },
    questions: [
      {
        id: 'mm21e1-da-1',
        text: "Given $\\frac{dy}{dx} = \\sqrt{x+6} - \\frac{x}{2} - \\frac{3}{2}$, verify that $x = 3$ is a stationary point and classify it.",
        hints: ["Check $\\frac{dy}{dx}|_{x=3} = 0$", "Find $\\frac{d^2y}{dx^2}$ and evaluate at $x = 3$"],
        answer: "$\\frac{dy}{dx}|_{x=3} = 3 - \\frac{3}{2} - \\frac{3}{2} = 0$ ✓. $\\frac{d^2y}{dx^2}|_{x=3} = \\frac{1}{6} - \\frac{1}{2} = -\\frac{1}{3} < 0$. Local maximum.",
        markingGuide: ['Verify stationary', 'Correct second derivative', 'Correct classification'],
        marks: 2,
      },
    ],
  },
  {
    id: 'mm21e1-antidiff-advanced',
    title: 'Advanced Antidifferentiation',
    description: 'Integrating $\\sqrt{x+a}$ and other composite forms, using initial conditions',
    prerequisites: ['mm21e1-antidiff-conditions'],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_3,
    tier: 2,
    position: { x: 7, y: 2 },
    questions: [
      {
        id: 'mm21e1-aa-1',
        text: "Find $y$ given $\\frac{dy}{dx} = \\sqrt{x+6} - \\frac{x}{2} - \\frac{3}{2}$ and the curve passes through $(3, \\frac{29}{4})$.",
        hints: ['$\\int \\sqrt{x+6}\\,dx = \\frac{2}{3}(x+6)^{3/2}$', 'Use the given point to find the constant'],
        answer: '$y = \\frac{2}{3}(x+6)^{3/2} - \\frac{x^2}{4} - \\frac{3x}{2} + c$. Using $(3, \\frac{29}{4})$: $c = -4$.',
        markingGuide: ['Correct integration of $\\sqrt{x+6}$', 'All terms integrated', 'Correct constant'],
        marks: 3,
      },
    ],
  },
  {
    id: 'mm21e1-trig-general',
    title: 'General Trig Solutions',
    description: 'Complete solutions to $\\sin(nx) = k$ over $R$, period and range analysis',
    prerequisites: ['mm21e1-trig-equations'],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_3,
    tier: 2,
    position: { x: 5, y: 2 },
    questions: [
      {
        id: 'mm21e1-tg-1',
        text: 'State the range and period of $g(x) = 2\\sin(2x)$, then solve $2\\sin(2x) = \\sqrt{3}$ for $x \\in R$.',
        hints: ['Range: $[-2, 2]$, Period: $\\pi$', 'Reduce to $\\sin(2x) = \\frac{\\sqrt{3}}{2}$'],
        answer: 'Range $[-2, 2]$. Period $\\pi$. $x = \\frac{\\pi}{6} + k\\pi$ or $x = \\frac{\\pi}{3} + k\\pi$.',
        markingGuide: ['Correct range and period', 'Both families of solutions'],
        marks: 3,
      },
    ],
  },
  {
    id: 'mm21e1-rational-inequality',
    title: 'Rational Function Inequalities',
    description: 'Solving $\\frac{a}{x-h} + k \\ge c$ using graph or algebra',
    prerequisites: ['mm21e1-rational-graphing'],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_3,
    tier: 2,
    position: { x: 9, y: 2 },
    questions: [
      {
        id: 'mm21e1-ri-1',
        text: 'Find the values of $x$ for which $1 - \\frac{2}{x-2} \\ge 3$.',
        hints: ['Rearrange: $-\\frac{2}{x-2} \\ge 2$', 'Solve $\\frac{2}{x-2} = -2$ to get $x = 1$', 'Use graph to determine correct interval'],
        answer: '$x \\le 1$ (on the left branch where $y \\ge 3$).',
        markingGuide: ['Correct critical value', 'Correct interval considering asymptote'],
        marks: 1,
      },
    ],
  },
  {
    id: 'mm21e1-quadratic-transformations',
    title: 'Quadratic Transformations',
    description: 'Transforming quadratics, finding intercepts of transformed functions',
    prerequisites: ['mm21e1-transformations'],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_3,
    tier: 2,
    position: { x: 3, y: 2 },
    questions: [
      {
        id: 'mm21e1-qt-1',
        text: '$f(x) = x^2 - 4$ and $g(x) = 4(x-1)^2 - 4$ share the intercept $(2, 0)$. Find the other x-intercept of $g$ and describe transformations from $f$ to a function $h(x) = 4(x-2)^2 - 4$.',
        hints: ['$g(x) = 0$: $(x-1)^2 = 1$, so $x = 0$ or $x = 2$', 'For $h$: dilation factor $\\frac{1}{2}$ from y-axis, then translate 2 right'],
        answer: 'Other intercept: $(0, 0)$. $h(x) = 4(x-2)^2 - 4$: intercepts $(1, 0)$ and $(3, 0)$.',
        markingGuide: ['Correct other intercept', 'Correct transformation description', 'Correct new intercepts'],
        marks: 2,
      },
    ],
  },
  {
    id: 'mm21e1-binomial-proportions',
    title: 'Binomial & Sample Proportions',
    description: '$\\text{Bi}(n, p)$ for sample proportions, $\\Pr(\\hat{P} \\ge k)$',
    prerequisites: ['mm21e1-conditional-probability'],
    topic: Topic.PROBABILITY,
    difficulty: Difficulty.STAR_3,
    tier: 2,
    position: { x: 11, y: 2 },
    questions: [
      {
        id: 'mm21e1-bsp-1',
        text: '$p = 0.5$, sample size $n = 5$. Find $\\Pr(\\hat{P} \\ge 0.8)$.',
        hints: ['$\\hat{P} \\ge 0.8$ means $X \\ge 4$ out of 5', '$X \\sim \\text{Bi}(5, 0.5)$'],
        answer: '$\\Pr(X \\ge 4) = \\binom{5}{4}(0.5)^5 + (0.5)^5 = \\frac{5+1}{32} = \\frac{3}{16}$',
        markingGuide: ['Correct binomial setup', 'Both terms', 'Correct total'],
        marks: 3,
      },
    ],
  },
  {
    id: 'mm21e1-continuous-pdf',
    title: 'Continuous PDF',
    description: '$\\int f(x)\\,dx = 1$, finding $k$, $E(X)$ via integration',
    prerequisites: ['mm21e1-basic-probability', 'mm21e1-basic-integration'],
    topic: Topic.PROBABILITY,
    difficulty: Difficulty.STAR_3,
    tier: 2,
    position: { x: 13, y: 2 },
    questions: [
      {
        id: 'mm21e1-cpdf-1',
        text: '$f(x) = \\frac{k}{x^2}$ for $1 \\le x \\le 2$. Show $k = 2$ and find $E(X)$.',
        hints: ['$\\int_1^2 \\frac{k}{x^2}\\,dx = 1$', '$E(X) = \\int_1^2 x \\cdot \\frac{2}{x^2}\\,dx = \\int_1^2 \\frac{2}{x}\\,dx$'],
        answer: '$\\frac{k}{2} = 1 \\implies k = 2$. $E(X) = 2[\\ln x]_1^2 = 2\\ln 2$.',
        markingGuide: ['Correct integral for k', 'Correct E(X) integral and evaluation'],
        marks: 3,
      },
    ],
  },

  // ===================== TIER 3-4: Exam Question Nodes =====================
  {
    id: 'mm21e1-exam-q1a',
    title: 'Q1a: Chain Rule',
    description: 'Differentiate $y = 2e^{-3x}$.',
    prerequisites: ['mm21e1-chain-rule'],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_2,
    tier: 3,
    position: { x: 2, y: 3 },
    isExamQuestion: true,
    examRef: { examId: 'mm-2021-exam1', year: 2021, subject: Subject.METHODS, questionNumber: 'Q1a', marks: 1 },
    questions: [
      {
        id: 'mm21e1-eq-1a',
        text: 'Differentiate $y = 2e^{-3x}$ with respect to $x$.',
        hints: ['Chain rule: $\\frac{d}{dx}e^{ax} = ae^{ax}$'],
        answer: '$\\frac{dy}{dx} = -6e^{-3x}$',
        markingGuide: ['Correct chain rule application: $-6e^{-3x}$'],
        marks: 1,
      },
    ],
  },
  {
    id: 'mm21e1-exam-q1b',
    title: 'Q1b: Product Rule',
    description: 'Evaluate $f\'(4)$ where $f(x) = x\\sqrt{2x+1}$.',
    prerequisites: ['mm21e1-product-rule'],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_3,
    tier: 3,
    position: { x: 0, y: 3 },
    isExamQuestion: true,
    examRef: { examId: 'mm-2021-exam1', year: 2021, subject: Subject.METHODS, questionNumber: 'Q1b', marks: 2 },
    questions: [
      {
        id: 'mm21e1-eq-1b',
        text: 'Evaluate $f\'(4)$, where $f(x) = x\\sqrt{2x+1}$.',
        hints: ["Product rule: $f'(x) = \\frac{3x+1}{\\sqrt{2x+1}}$", 'Substitute $x = 4$'],
        answer: "$f'(4) = \\frac{13}{\\sqrt{9}} = \\frac{13}{3}$",
        markingGuide: ['Correct product rule derivative', 'Correct evaluation at $x = 4$'],
        marks: 2,
      },
    ],
  },
  {
    id: 'mm21e1-exam-q2',
    title: 'Q2: Antidifferentiation',
    description: "Find $f(x)$ given $f'(x) = x^3 + x$ and $f(1) = 2$.",
    prerequisites: ['mm21e1-antidiff-conditions'],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_2,
    tier: 3,
    position: { x: 8, y: 3 },
    isExamQuestion: true,
    examRef: { examId: 'mm-2021-exam1', year: 2021, subject: Subject.METHODS, questionNumber: 'Q2', marks: 2 },
    questions: [
      {
        id: 'mm21e1-eq-2',
        text: "Let $f'(x) = x^3 + x$. Find $f(x)$ given that $f(1) = 2$.",
        hints: ['Integrate term by term', 'Use $f(1) = 2$ to find $c$'],
        answer: '$f(x) = \\frac{x^4}{4} + \\frac{x^2}{2} + \\frac{5}{4}$',
        markingGuide: ['Correct antiderivative', '$c = \\frac{5}{4}$'],
        marks: 2,
      },
    ],
  },
  {
    id: 'mm21e1-exam-q3',
    title: 'Q3: Trig Function Analysis',
    description: '$g(x) = 2\\sin(2x)$: range, period, and solving $2\\sin(2x) = \\sqrt{3}$.',
    prerequisites: ['mm21e1-trig-general'],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_3,
    tier: 3,
    position: { x: 5, y: 3 },
    isExamQuestion: true,
    examRef: { examId: 'mm-2021-exam1', year: 2021, subject: Subject.METHODS, questionNumber: 'Q3', marks: 5 },
    questions: [
      {
        id: 'mm21e1-eq-3',
        text: 'Consider $g: R \\to R, g(x) = 2\\sin(2x)$.\na. State the range of $g$.\nb. State the period of $g$.\nc. Solve $2\\sin(2x) = \\sqrt{3}$ for $x \\in R$.',
        hints: ['a. Amplitude = 2', 'b. Period = $\\frac{2\\pi}{2}$', 'c. $\\sin(2x) = \\frac{\\sqrt{3}}{2}$, base angle $\\frac{\\pi}{3}$'],
        answer: 'a. $[-2, 2]$. b. $\\pi$. c. $x = \\frac{\\pi}{6} + k\\pi$ or $x = \\frac{\\pi}{3} + k\\pi$.',
        markingGuide: ['Correct range', 'Correct period', 'Both solution families with general $k$'],
        marks: 5,
      },
    ],
  },
  {
    id: 'mm21e1-exam-q4',
    title: 'Q4: Rational Function',
    description: 'Sketch $y = 1 - \\frac{2}{x-2}$ and solve $1 - \\frac{2}{x-2} \\ge 3$.',
    prerequisites: ['mm21e1-rational-inequality'],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_3,
    tier: 3,
    position: { x: 10, y: 3 },
    isExamQuestion: true,
    examRef: { examId: 'mm-2021-exam1', year: 2021, subject: Subject.METHODS, questionNumber: 'Q4', marks: 4 },
    questions: [
      {
        id: 'mm21e1-eq-4',
        text: 'a. Sketch $y = 1 - \\frac{2}{x-2}$, labelling asymptotes and intercepts.\nb. Find values of $x$ for which $1 - \\frac{2}{x-2} \\ge 3$.',
        hints: ['VA: $x=2$, HA: $y=1$', 'x-int: $(4, 0)$, y-int: $(0, 2)$', 'b. Solve $\\frac{2}{x-2} = -2$ to find critical value'],
        answer: 'a. Asymptotes $x=2, y=1$. Intercepts $(4,0), (0,2)$. b. $x \\le 1$.',
        markingGuide: ['Correct sketch', 'All asymptotes and intercepts', 'Correct inequality solution'],
        marks: 4,
      },
    ],
  },
  {
    id: 'mm21e1-exam-q5',
    title: 'Q5: Quadratics & Transformations',
    description: '$f(x) = x^2 - 4$ and $g(x) = 4(x-1)^2 - 4$: intercepts and transformations.',
    prerequisites: ['mm21e1-quadratic-transformations'],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_3,
    tier: 3,
    position: { x: 3, y: 3 },
    isExamQuestion: true,
    examRef: { examId: 'mm-2021-exam1', year: 2021, subject: Subject.METHODS, questionNumber: 'Q5', marks: 4 },
    questions: [
      {
        id: 'mm21e1-eq-5',
        text: 'Let $f(x) = x^2 - 4$ and $g(x) = 4(x-1)^2 - 4$. They share the intercept $(2, 0)$.\na. Find the other x-intercept of $g$.\nb. Apply dilation by $\\frac{1}{2}$ from y-axis then translation 2 right to $f$. State the rule of $h$ and its intercepts.',
        hints: ['a. $g(x) = 0 \\implies (x-1)^2 = 1$', 'b. Step 1: $f(2x) = 4x^2 - 4$. Step 2: replace $x$ with $x-2$'],
        answer: 'a. $(0, 0)$. b. $h(x) = 4(x-2)^2 - 4$. Intercepts: $(1, 0)$ and $(3, 0)$.',
        markingGuide: ['Other intercept of g', 'Correct transformation steps', 'Rule of h', 'Intercepts of h'],
        marks: 4,
      },
    ],
  },
  {
    id: 'mm21e1-exam-q6',
    title: 'Q6: Probability with Doughnuts',
    description: 'Basic probability, conditional probability with boxes, sample proportions.',
    prerequisites: ['mm21e1-binomial-proportions', 'mm21e1-conditional-probability'],
    topic: Topic.PROBABILITY,
    difficulty: Difficulty.STAR_3,
    tier: 3,
    position: { x: 12, y: 3 },
    isExamQuestion: true,
    examRef: { examId: 'mm-2021-exam1', year: 2021, subject: Subject.METHODS, questionNumber: 'Q6', marks: 6 },
    questions: [
      {
        id: 'mm21e1-eq-6',
        text: "20 doughnuts: $\\frac{1}{2}$ custard, $\\frac{7}{10}$ not glazed, $\\frac{1}{10}$ glazed with custard.\na. $\\Pr(\\text{not glazed, with custard})$.\nb. Split into Box A (10) and Box B (10). $g$ glazed in Box A. Find $\\Pr(B | \\text{glazed})$ in terms of $g$.\nc. $p = 0.5$, sample of 5 visitors. Find $\\Pr(\\hat{P} \\ge 0.8)$.",
        hints: ['a. Custard = 10, glazed+custard = 2', 'b. Total glazed = 6, use Bayes', 'c. $X \\sim \\text{Bi}(5, 0.5)$, need $X \\ge 4$'],
        answer: 'a. $\\frac{2}{5}$. b. $\\frac{6-g}{6}$. c. $\\frac{3}{16}$.',
        markingGuide: ['Correct basic probability', 'Bayes with parameter g', 'Binomial for sample proportion'],
        marks: 6,
      },
    ],
  },
  {
    id: 'mm21e1-exam-q7',
    title: 'Q7: Continuous PDF',
    description: '$f(x) = \\frac{k}{x^2}$ for $1 \\le x \\le 2$: show $k = 2$, find $E(X)$.',
    prerequisites: ['mm21e1-continuous-pdf'],
    topic: Topic.PROBABILITY,
    difficulty: Difficulty.STAR_3,
    tier: 3,
    position: { x: 14, y: 3 },
    isExamQuestion: true,
    examRef: { examId: 'mm-2021-exam1', year: 2021, subject: Subject.METHODS, questionNumber: 'Q7', marks: 3 },
    questions: [
      {
        id: 'mm21e1-eq-7',
        text: "$f(x) = \\frac{k}{x^2}$ for $1 \\le x \\le 2$, $0$ elsewhere.\na. Show that $k = 2$.\nb. Find $E(X)$.",
        hints: ['a. $\\int_1^2 \\frac{k}{x^2}\\,dx = 1$', 'b. $E(X) = \\int_1^2 \\frac{2}{x}\\,dx$'],
        answer: 'a. $k[-\\frac{1}{x}]_1^2 = \\frac{k}{2} = 1 \\implies k = 2$. b. $E(X) = 2\\log_e(2)$.',
        markingGuide: ['Correct integral for showing k', 'Correct E(X) calculation'],
        marks: 3,
      },
    ],
  },
  {
    id: 'mm21e1-exam-q8',
    title: 'Q8: Antidiff & Stationary Points',
    description: 'Find $y$ from gradient rule with $\\sqrt{x+6}$, classify stationary point.',
    prerequisites: ['mm21e1-antidiff-advanced', 'mm21e1-derivative-analysis'],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_4,
    tier: 3,
    position: { x: 7, y: 4 },
    isExamQuestion: true,
    examRef: { examId: 'mm-2021-exam1', year: 2021, subject: Subject.METHODS, questionNumber: 'Q8', marks: 5 },
    questions: [
      {
        id: 'mm21e1-eq-8',
        text: "$\\frac{dy}{dx} = \\sqrt{x+6} - \\frac{x}{2} - \\frac{3}{2}$. Stationary point at $(3, \\frac{29}{4})$.\na. Find the rule of the function.\nb. Determine the nature of the stationary point.",
        hints: ['a. $\\int \\sqrt{x+6}\\,dx = \\frac{2}{3}(x+6)^{3/2}$', 'b. $\\frac{d^2y}{dx^2} = \\frac{1}{2\\sqrt{x+6}} - \\frac{1}{2}$'],
        answer: "a. $y = \\frac{2}{3}(x+6)^{3/2} - \\frac{x^2}{4} - \\frac{3x}{2} - 4$. b. $f''(3) = \\frac{1}{6} - \\frac{1}{2} = -\\frac{1}{3} < 0$: local max.",
        markingGuide: ['Correct antiderivative', 'Correct constant', 'Second derivative test', 'Correct classification'],
        marks: 5,
      },
    ],
  },
  {
    id: 'mm21e1-exam-q9',
    title: 'Q9: Unit Circle, Tangent & Transformations',
    description: 'Tangent from external point to unit circle, transformation intersections, triangle area optimization.',
    prerequisites: ['mm21e1-quadratic-transformations', 'mm21e1-derivative-analysis'],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_5,
    tier: 4,
    position: { x: 3, y: 4 },
    isExamQuestion: true,
    examRef: { examId: 'mm-2021-exam1', year: 2021, subject: Subject.METHODS, questionNumber: 'Q9', marks: 8 },
    questions: [
      {
        id: 'mm21e1-eq-9',
        text: "Unit circle $x^2 + y^2 = 1$, tangent from $A(2,0)$ touches at $P$.\na. Show the line through $A$ and $P$ is $y = -\\frac{x}{\\sqrt{3}} + \\frac{2}{\\sqrt{3}}$.\nb.i. Transformation $T$ dilates by $q$ from x-axis. Find $q$ for graph of $h$ to intersect circle at least once.\nb.ii. Find $q$ for both intersections having positive coordinates.\nc.i. Define area function $g(\\theta)$ for triangle $OAP'$.\nc.ii. Find maximum area.",
        hints: ['a. $P = (\\frac{1}{2}, \\frac{\\sqrt{3}}{2})$, gradient = $-\\frac{1}{\\sqrt{3}}$', 'b. Substitute transformed line into circle equation', 'c. Area = $|\\sin\\theta|$, max = 1'],
        answer: "a. Slope $= \\frac{\\sqrt{3}/2}{1/2-2} = -\\frac{1}{\\sqrt{3}}$. b.i. $|q| \\ge \\frac{1}{\\sqrt{3}}$. b.ii. $q > \\frac{1}{\\sqrt{3}}$. c.ii. Max area = 1.",
        markingGuide: ['Line equation derivation', 'Discriminant condition', 'Positive coordinate condition', 'Area function', 'Maximum area'],
        marks: 8,
      },
    ],
  },
];

export const MM_2021_EXAM1_TREE: SkillTreeData = {
  id: 'mm-2021-exam1',
  title: 'Methods 2021 Exam 1',
  description: 'VCE Mathematical Methods 2021 — Exam 1 (Technology Free)',
  subject: Subject.METHODS,
  year: 2021,
  nodes,
  totalMarks: 40,
};
