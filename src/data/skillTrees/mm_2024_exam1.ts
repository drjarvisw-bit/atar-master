import { Topic, Subject, Difficulty, type SkillTreeNode, type SkillTreeData } from '../../types';

const nodes: SkillTreeNode[] = [
  // ===================== TIER 0: Foundation Skills =====================
  {
    id: 'mm24e1-basic-derivatives',
    title: 'Basic Derivatives',
    description: 'Power rule, exponential, trig, and log derivatives',
    prerequisites: [],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_1,
    tier: 0,
    position: { x: 1, y: 0 },
    questions: [
      {
        id: 'mm24e1-bd-1',
        text: 'Find the derivative of $f(x) = e^x$.',
        hints: ['The derivative of $e^x$ is itself'],
        answer: "$f'(x) = e^x$",
        markingGuide: ['Correct standard derivative'],
        marks: 1,
      },
      {
        id: 'mm24e1-bd-2',
        text: 'Differentiate $y = \\cos(3x)$.',
        hints: ['Use chain rule: derivative of $\\cos(u)$ is $-\\sin(u) \\cdot u\'$'],
        answer: "$\\frac{dy}{dx} = -3\\sin(3x)$",
        markingGuide: ['Correct chain rule application'],
        marks: 1,
      },
    ],
  },
  {
    id: 'mm24e1-basic-functions',
    title: 'Function Basics',
    description: 'Domain, range, evaluating functions, asymptotes',
    prerequisites: [],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_1,
    tier: 0,
    position: { x: 3, y: 0 },
    questions: [
      {
        id: 'mm24e1-bf-1',
        text: 'If $h(t) = \\frac{3000}{t+1}$, find $h(4)$.',
        hints: ['Substitute $t = 4$ into the expression'],
        answer: '$h(4) = \\frac{3000}{5} = 600$',
        markingGuide: ['Correct substitution and evaluation'],
        marks: 1,
      },
    ],
  },
  {
    id: 'mm24e1-basic-probability',
    title: 'Probability Fundamentals',
    description: 'Basic probability rules, binomial formula',
    prerequisites: [],
    topic: Topic.PROBABILITY,
    difficulty: Difficulty.STAR_1,
    tier: 0,
    position: { x: 5, y: 0 },
    questions: [
      {
        id: 'mm24e1-bp-1',
        text: 'If $X \\sim \\text{Bi}(4, 0.9)$, find $\\Pr(X = 4)$.',
        hints: ['$\\Pr(X = n) = p^n$ for binomial with all successes'],
        answer: '$\\Pr(X = 4) = (0.9)^4 = 0.6561$',
        markingGuide: ['Correct binomial calculation'],
        marks: 1,
      },
    ],
  },
  {
    id: 'mm24e1-basic-integration',
    title: 'Basic Integration',
    description: 'Antiderivatives, power rule for integration, initial conditions',
    prerequisites: [],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_1,
    tier: 0,
    position: { x: 7, y: 0 },
    questions: [
      {
        id: 'mm24e1-bi-1',
        text: 'Find $\\int (x+3)^{-2} \\, dx$.',
        hints: ['Use the power rule for integration: $\\int u^n du = \\frac{u^{n+1}}{n+1} + c$'],
        answer: '$-(x+3)^{-1} + c = -\\frac{1}{x+3} + c$',
        markingGuide: ['Correct antiderivative with constant'],
        marks: 1,
      },
    ],
  },
  {
    id: 'mm24e1-trig-basics',
    title: 'Trigonometric Functions',
    description: 'Unit circle values, $x\\sin(x)$, trig function properties',
    prerequisites: [],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_1,
    tier: 0,
    position: { x: 9, y: 0 },
    questions: [
      {
        id: 'mm24e1-tb-1',
        text: 'Evaluate $\\sin(\\frac{\\pi}{3})$ and $\\sin(\\frac{2\\pi}{3})$.',
        hints: ['$\\sin(\\frac{\\pi}{3}) = \\frac{\\sqrt{3}}{2}$', '$\\sin(\\pi - \\theta) = \\sin(\\theta)$'],
        answer: 'Both equal $\\frac{\\sqrt{3}}{2}$.',
        markingGuide: ['Correct values'],
        marks: 1,
      },
    ],
  },
  {
    id: 'mm24e1-exponential-log-basics',
    title: 'Exponential & Log Basics',
    description: 'Log laws, solving log equations, change of base',
    prerequisites: [],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_1,
    tier: 0,
    position: { x: 11, y: 0 },
    questions: [
      {
        id: 'mm24e1-elb-1',
        text: 'Simplify $2\\log_3(x-4) + \\log_3(x)$ into a single logarithm.',
        hints: ['$2\\log_3(x-4) = \\log_3((x-4)^2)$', 'Then use $\\log_a + \\log_b = \\log(ab)$'],
        answer: '$\\log_3(x(x-4)^2)$',
        markingGuide: ['Correct log law application'],
        marks: 1,
      },
    ],
  },
  {
    id: 'mm24e1-polynomial-basics',
    title: 'Polynomial & Cube Root Functions',
    description: 'Cube roots, polynomial structure, factor theorem',
    prerequisites: [],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_1,
    tier: 0,
    position: { x: 13, y: 0 },
    questions: [
      {
        id: 'mm24e1-pb-1',
        text: 'Evaluate $\\sqrt[3]{-8}$.',
        hints: ['Cube root of negative numbers is negative'],
        answer: '$\\sqrt[3]{-8} = -2$',
        markingGuide: ['Correct evaluation'],
        marks: 1,
      },
    ],
  },

  // ===================== TIER 1: Intermediate Skills =====================
  {
    id: 'mm24e1-product-rule',
    title: 'Product Rule',
    description: "Differentiate products: $(uv)' = u'v + uv'$",
    prerequisites: ['mm24e1-basic-derivatives'],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_2,
    tier: 1,
    position: { x: 0, y: 1 },
    questions: [
      {
        id: 'mm24e1-pr-1',
        text: 'Find $\\frac{d}{dx}[e^x \\cos(3x)]$.',
        hints: ['Let $u = e^x$ and $v = \\cos(3x)$', "Apply $(uv)' = u'v + uv'$"],
        answer: '$e^x\\cos(3x) - 3e^x\\sin(3x) = e^x(\\cos(3x) - 3\\sin(3x))$',
        markingGuide: ['Correct product rule', 'Simplified form'],
        marks: 1,
      },
    ],
  },
  {
    id: 'mm24e1-chain-rule',
    title: 'Chain Rule',
    description: "Differentiate composites: $\\frac{d}{dx}f(g(x)) = f'(g(x)) \\cdot g'(x)$",
    prerequisites: ['mm24e1-basic-derivatives'],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_2,
    tier: 1,
    position: { x: 2, y: 1 },
    questions: [
      {
        id: 'mm24e1-cr-1',
        text: 'Find $f\'(x)$ where $f(x) = \\log_e(x^3 - 3x + 2)$.',
        hints: ['Chain rule: $\\frac{d}{dx}\\log_e(u) = \\frac{u\'}{u}$'],
        answer: "$f'(x) = \\frac{3x^2 - 3}{x^3 - 3x + 2}$",
        markingGuide: ['Correct chain rule application'],
        marks: 2,
      },
    ],
  },
  {
    id: 'mm24e1-binomial-distribution',
    title: 'Binomial Distribution',
    description: '$X \\sim \\text{Bi}(n, p)$: probability, mean, variance, standard deviation',
    prerequisites: ['mm24e1-basic-probability'],
    topic: Topic.PROBABILITY,
    difficulty: Difficulty.STAR_2,
    tier: 1,
    position: { x: 4, y: 1 },
    questions: [
      {
        id: 'mm24e1-bd2-1',
        text: 'If $X \\sim \\text{Bi}(4, 0.9)$, find the standard deviation of $X$.',
        hints: ['$\\text{Var}(X) = np(1-p)$', '$\\text{SD}(X) = \\sqrt{\\text{Var}(X)}$'],
        answer: '$\\text{Var} = 4(0.9)(0.1) = 0.36$. $\\text{SD} = \\sqrt{0.36} = 0.6$.',
        markingGuide: ['Correct variance', 'Correct standard deviation'],
        marks: 1,
      },
    ],
  },
  {
    id: 'mm24e1-graphing-rationals',
    title: 'Graphing Rational Functions',
    description: 'Asymptotes, intercepts, and shapes of $\\frac{a}{(x-h)^n} + k$',
    prerequisites: ['mm24e1-basic-functions'],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_2,
    tier: 1,
    position: { x: 6, y: 1 },
    questions: [
      {
        id: 'mm24e1-gr-1',
        text: 'State the asymptotes and y-intercept of $g(x) = \\frac{1}{(x+3)^2} - 2$.',
        hints: ['Vertical asymptote where denominator is zero', 'Horizontal asymptote is the constant term', 'Substitute $x = 0$ for y-intercept'],
        answer: 'VA: $x = -3$, HA: $y = -2$. y-int: $g(0) = \\frac{1}{9} - 2 = -\\frac{17}{9}$.',
        markingGuide: ['Both asymptotes', 'Correct y-intercept'],
        marks: 2,
      },
    ],
  },
  {
    id: 'mm24e1-trapezium-rule',
    title: 'Trapezium Rule',
    description: 'Numerical integration using trapeziums with given step size',
    prerequisites: ['mm24e1-basic-integration', 'mm24e1-trig-basics'],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_2,
    tier: 1,
    position: { x: 8, y: 1 },
    questions: [
      {
        id: 'mm24e1-tr-1',
        text: 'State the trapezium rule formula for $n$ strips of width $h$.',
        hints: ['$\\int_a^b f(x)\\,dx \\approx \\frac{h}{2}(y_0 + 2y_1 + 2y_2 + \\ldots + 2y_{n-1} + y_n)$'],
        answer: '$\\frac{h}{2}(y_0 + 2(y_1 + y_2 + \\ldots + y_{n-1}) + y_n)$',
        markingGuide: ['Correct formula'],
        marks: 1,
      },
    ],
  },
  {
    id: 'mm24e1-log-equations',
    title: 'Logarithmic Equations',
    description: 'Solving equations with multiple log terms, domain restrictions',
    prerequisites: ['mm24e1-exponential-log-basics'],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_2,
    tier: 1,
    position: { x: 12, y: 1 },
    questions: [
      {
        id: 'mm24e1-le-1',
        text: 'Solve $\\log_3(x) = 2$ for $x$.',
        hints: ['Convert to exponential form: $x = 3^2$'],
        answer: '$x = 9$',
        markingGuide: ['Correct conversion and solution'],
        marks: 1,
      },
    ],
  },
  {
    id: 'mm24e1-confidence-intervals',
    title: 'Confidence Intervals',
    description: '95% CI for proportions, sample size calculations',
    prerequisites: ['mm24e1-basic-probability'],
    topic: Topic.PROBABILITY,
    difficulty: Difficulty.STAR_2,
    tier: 1,
    position: { x: 14, y: 1 },
    questions: [
      {
        id: 'mm24e1-ci-1',
        text: 'In a sample of 100 people, 60 are unhappy. Find the 95% CI using $z = 2$.',
        hints: ['$\\hat{p} = 0.6$', 'Margin $= z\\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}}$'],
        answer: '$0.6 \\pm 2\\sqrt{\\frac{0.24}{100}} \\approx 0.6 \\pm 0.1 = (0.5, 0.7)$',
        markingGuide: ['Correct margin of error', 'Correct interval'],
        marks: 2,
      },
    ],
  },

  // ===================== TIER 2: Advanced Skills =====================
  {
    id: 'mm24e1-function-analysis',
    title: 'Derivative Analysis',
    description: "Finding and interpreting $f'(x)$: stationary points, IVT, sketching derivatives",
    prerequisites: ['mm24e1-product-rule', 'mm24e1-chain-rule'],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_3,
    tier: 2,
    position: { x: 1, y: 2 },
    questions: [
      {
        id: 'mm24e1-fa-1',
        text: "Let $f(x) = x\\sin(x)$. Find $f'(x)$ and show there is a stationary point in $[\\frac{\\pi}{2}, \\frac{2\\pi}{3}]$.",
        hints: ["Product rule: $f'(x) = \\sin(x) + x\\cos(x)$", "Check $f'(\\frac{\\pi}{2})$ and $f'(\\frac{2\\pi}{3})$ for sign change"],
        answer: "$f'(\\pi/2) = 1 > 0$, $f'(2\\pi/3) = \\frac{\\sqrt{3}}{2} - \\frac{\\pi}{3} < 0$. By IVT, a root exists.",
        markingGuide: ['Correct derivative', 'Sign change established', 'IVT conclusion'],
        marks: 3,
      },
    ],
  },
  {
    id: 'mm24e1-area-under-curve',
    title: 'Area Under Curves',
    description: 'Definite integrals for area, handling regions below x-axis',
    prerequisites: ['mm24e1-trapezium-rule'],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_3,
    tier: 2,
    position: { x: 7, y: 2 },
    questions: [
      {
        id: 'mm24e1-auc-1',
        text: 'Find the area bounded by $y = \\frac{1}{(x+3)^2} - 2$, $x = -2$, $x = 0$, and the x-axis.',
        hints: ['The function is below the x-axis in this region', 'Area = $|\\int_{-2}^{0} g(x)\\,dx|$'],
        answer: '$\\int_{-2}^0 (\\frac{1}{(x+3)^2} - 2)\\,dx = [-\\frac{1}{x+3} - 2x]_{-2}^0 = -\\frac{10}{3}$. Area = $\\frac{10}{3}$.',
        markingGuide: ['Correct antiderivative', 'Correct evaluation', 'Magnitude for area'],
        marks: 2,
      },
    ],
  },
  {
    id: 'mm24e1-simultaneous-equations',
    title: 'Simultaneous Equations',
    description: 'Determinant method for no-solution / infinite solutions cases',
    prerequisites: ['mm24e1-graphing-rationals'],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_3,
    tier: 2,
    position: { x: 5, y: 2 },
    questions: [
      {
        id: 'mm24e1-se-1',
        text: 'For $3kx - 2y = k+4$ and $(k-4)x + ky = -k$, find $k$ giving no solution.',
        hints: ['Determinant $\\Delta = 3k^2 + 2k - 8 = 0$', 'Factor: $(3k-4)(k+2) = 0$', 'Check each for parallel vs coincident'],
        answer: '$k = \\frac{4}{3}$ (parallel lines — no solution). $k = -2$ gives coincident lines (infinite solutions).',
        markingGuide: ['Correct determinant', 'Factor correctly', 'Distinguish parallel from coincident'],
        marks: 3,
      },
    ],
  },
  {
    id: 'mm24e1-transformations',
    title: 'Function Transformations',
    description: 'Dilations, translations, and their effect on function rules',
    prerequisites: ['mm24e1-graphing-rationals'],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_3,
    tier: 2,
    position: { x: 3, y: 2 },
    questions: [
      {
        id: 'mm24e1-tf-1',
        text: "$h(t) = \\frac{3000}{t+1}$ models a population. A new model $h_1$ has $h_1(0) = h(0)$ but $h_1'(t) = 0.5h'(t)$. State the two transformations mapping $h$ to $h_1$.",
        hints: ['$h_1(t) = 0.5h(t) + c$', 'Use $h_1(0) = h(0)$ to find $c$'],
        answer: 'Dilation by factor 0.5 from t-axis, then translation 1500 units up.',
        markingGuide: ['Correct dilation', 'Correct translation'],
        marks: 2,
      },
    ],
  },
  {
    id: 'mm24e1-binomial-calculations',
    title: 'Binomial Calculations',
    description: '$\\Pr(X < k)$, cumulative probabilities, sample proportion SD',
    prerequisites: ['mm24e1-binomial-distribution', 'mm24e1-confidence-intervals'],
    topic: Topic.PROBABILITY,
    difficulty: Difficulty.STAR_3,
    tier: 2,
    position: { x: 9, y: 2 },
    questions: [
      {
        id: 'mm24e1-bc-1',
        text: 'If $X \\sim \\text{Bi}(4, 0.9)$, find $\\Pr(X < 2)$.',
        hints: ['$\\Pr(X < 2) = \\Pr(X=0) + \\Pr(X=1)$', '$\\Pr(X=0) = (0.1)^4$'],
        answer: '$\\Pr(X=0) = 0.0001$, $\\Pr(X=1) = 4(0.9)(0.1)^3 = 0.0036$. Total: $0.0037$.',
        markingGuide: ['Both terms calculated', 'Correct total'],
        marks: 2,
      },
    ],
  },
  {
    id: 'mm24e1-log-cubics',
    title: 'Logarithmic & Cubic Equations',
    description: 'Converting log equations to polynomial form, factor theorem',
    prerequisites: ['mm24e1-log-equations', 'mm24e1-polynomial-basics'],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_3,
    tier: 2,
    position: { x: 11, y: 2 },
    questions: [
      {
        id: 'mm24e1-lc-1',
        text: 'Solve $2\\log_3(x-4) + \\log_3(x) = 2$.',
        hints: ['Combine: $\\log_3(x(x-4)^2) = 2$', 'So $x(x-4)^2 = 9$', 'Expand to cubic and use factor theorem'],
        answer: '$x^3 - 8x^2 + 16x - 9 = 0$. $(x-1)(x^2-7x+9) = 0$. With $x > 4$: $x = \\frac{7+\\sqrt{13}}{2}$.',
        markingGuide: ['Correct log combination', 'Correct cubic', 'Factor theorem with x=1', 'Domain check'],
        marks: 4,
      },
    ],
  },
  {
    id: 'mm24e1-cube-root-analysis',
    title: 'Cube Root Function Analysis',
    description: 'Derivatives of $(x-k)^{1/3}$, gradient matching, intercepts in terms of parameters',
    prerequisites: ['mm24e1-chain-rule', 'mm24e1-polynomial-basics'],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_3,
    tier: 2,
    position: { x: 13, y: 2 },
    questions: [
      {
        id: 'mm24e1-cra-1',
        text: 'Let $g(x) = (x-k)^{1/3} + m$. Find $g\'(x)$ and $g\'(0)$.',
        hints: ["$g'(x) = \\frac{1}{3}(x-k)^{-2/3}$"],
        answer: "$g'(0) = \\frac{1}{3}(-k)^{-2/3} = \\frac{1}{3k^{2/3}}$",
        markingGuide: ['Correct derivative', 'Correct evaluation at x=0'],
        marks: 2,
      },
    ],
  },

  // ===================== TIER 3-4: Exam Question Nodes =====================
  {
    id: 'mm24e1-exam-q1a',
    title: 'Q1a: Product Rule',
    description: 'Let $y = e^x \\cos(3x)$. Find $\\frac{dy}{dx}$.',
    prerequisites: ['mm24e1-product-rule'],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_2,
    tier: 3,
    position: { x: 0, y: 3 },
    isExamQuestion: true,
    examRef: { examId: 'mm-2024-1', year: 2024, subject: Subject.METHODS, questionNumber: 'Q1a', marks: 1 },
    questions: [
      {
        id: 'mm24e1-eq-1a',
        text: 'Let $y = e^x \\cos(3x)$. Find $\\frac{dy}{dx}$.',
        hints: ['Apply product rule with $u = e^x$ and $v = \\cos(3x)$'],
        answer: '$e^x(\\cos(3x) - 3\\sin(3x))$',
        markingGuide: ['Apply product rule: $u=e^x, v=\\cos(3x)$', "$u'=e^x, v'=-3\\sin(3x)$", 'Combine and factor $e^x$'],
        marks: 1,
      },
    ],
  },
  {
    id: 'mm24e1-exam-q1b',
    title: 'Q1b: Chain Rule with Log',
    description: 'Let $f(x) = \\log_e(x^3 - 3x + 2)$. Find $f\'(3)$.',
    prerequisites: ['mm24e1-chain-rule'],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_3,
    tier: 3,
    position: { x: 2, y: 3 },
    isExamQuestion: true,
    examRef: { examId: 'mm-2024-1', year: 2024, subject: Subject.METHODS, questionNumber: 'Q1b', marks: 2 },
    questions: [
      {
        id: 'mm24e1-eq-1b',
        text: 'Let $f(x) = \\log_e(x^3 - 3x + 2)$. Find $f\'(3)$.',
        hints: ["$f'(x) = \\frac{3x^2-3}{x^3-3x+2}$", 'Substitute $x = 3$'],
        answer: "$f'(3) = \\frac{27-3}{27-9+2} = \\frac{24}{20} = \\frac{6}{5}$",
        markingGuide: ['Chain rule applied', 'Correct substitution', 'Simplified to $6/5$'],
        marks: 2,
      },
    ],
  },
  {
    id: 'mm24e1-exam-q2',
    title: 'Q2: Simultaneous Equations',
    description: 'Find $k$ for no solution in $3kx - 2y = k+4$ and $(k-4)x + ky = -k$.',
    prerequisites: ['mm24e1-simultaneous-equations'],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_3,
    tier: 3,
    position: { x: 5, y: 3 },
    isExamQuestion: true,
    examRef: { examId: 'mm-2024-1', year: 2024, subject: Subject.METHODS, questionNumber: 'Q2', marks: 3 },
    questions: [
      {
        id: 'mm24e1-eq-2',
        text: 'Determine $k$ for which $3kx - 2y = k+4$ and $(k-4)x + ky = -k$ has no real solution.',
        hints: ['$\\Delta = 3k(k) - (-2)(k-4) = 3k^2 + 2k - 8$', 'Factor: $(3k-4)(k+2) = 0$', 'Test each value'],
        answer: '$k = \\frac{4}{3}$ (parallel lines). $k = -2$ gives coincident lines.',
        markingGuide: ['Correct determinant equation', 'Both candidate values', 'Correct distinction'],
        marks: 3,
      },
    ],
  },
  {
    id: 'mm24e1-exam-q3a',
    title: 'Q3a: Graphing Rational Functions',
    description: 'Sketch $g(x) = \\frac{1}{(x+3)^2} - 2$ with asymptotes and intercepts.',
    prerequisites: ['mm24e1-graphing-rationals'],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_3,
    tier: 3,
    position: { x: 4, y: 3 },
    isExamQuestion: true,
    examRef: { examId: 'mm-2024-1', year: 2024, subject: Subject.METHODS, questionNumber: 'Q3a', marks: 3 },
    questions: [
      {
        id: 'mm24e1-eq-3a',
        text: 'Sketch $y = \\frac{1}{(x+3)^2} - 2$, labelling asymptotes and intercepts.',
        hints: ['VA at $x = -3$, HA at $y = -2$', 'y-int at $(0, -\\frac{17}{9})$', 'x-ints: $(x+3)^2 = \\frac{1}{2}$'],
        answer: 'VA: $x=-3$, HA: $y=-2$. y-int: $(0, -\\frac{17}{9})$. x-ints: $(-3 \\pm \\frac{\\sqrt{2}}{2}, 0)$.',
        markingGuide: ['Both asymptotes', 'y-intercept', 'Both x-intercepts', 'Correct shape'],
        marks: 3,
      },
    ],
  },
  {
    id: 'mm24e1-exam-q3b',
    title: 'Q3b: Area Under Curve',
    description: 'Area bounded by $g(x)$, $x=-2$, x-axis, and y-axis.',
    prerequisites: ['mm24e1-area-under-curve'],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_3,
    tier: 3,
    position: { x: 7, y: 3 },
    isExamQuestion: true,
    examRef: { examId: 'mm-2024-1', year: 2024, subject: Subject.METHODS, questionNumber: 'Q3b', marks: 2 },
    questions: [
      {
        id: 'mm24e1-eq-3b',
        text: 'Determine the area bounded by $x=-2$, the x-axis, the y-axis, and $y = \\frac{1}{(x+3)^2} - 2$.',
        hints: ['Integrate from $-2$ to $0$', 'Antiderivative of $(x+3)^{-2}$ is $-(x+3)^{-1}$'],
        answer: 'Area $= \\frac{10}{3}$.',
        markingGuide: ['Correct integral setup', 'Correct antiderivative', 'Correct evaluation'],
        marks: 2,
      },
    ],
  },
  {
    id: 'mm24e1-exam-q4',
    title: 'Q4: Binomial Distribution',
    description: '$X \\sim \\text{Bi}(4, 0.9)$: standard deviation and $\\Pr(X < 2)$.',
    prerequisites: ['mm24e1-binomial-calculations'],
    topic: Topic.PROBABILITY,
    difficulty: Difficulty.STAR_3,
    tier: 3,
    position: { x: 9, y: 3 },
    isExamQuestion: true,
    examRef: { examId: 'mm-2024-1', year: 2024, subject: Subject.METHODS, questionNumber: 'Q4', marks: 3 },
    questions: [
      {
        id: 'mm24e1-eq-4',
        text: 'Let $X \\sim \\text{Bi}(4, \\frac{9}{10})$.\na. Find the standard deviation of $X$.\nb. Find $\\Pr(X < 2)$.',
        hints: ['$\\text{Var}(X) = np(1-p)$', '$\\Pr(X < 2) = \\Pr(X=0) + \\Pr(X=1)$'],
        answer: 'a. $\\text{SD} = 0.6$. b. $\\Pr(X < 2) = 0.0001 + 0.0036 = 0.0037$.',
        markingGuide: ['Correct SD', 'Both binomial terms', 'Correct total'],
        marks: 3,
      },
    ],
  },
  {
    id: 'mm24e1-exam-q5',
    title: 'Q5: Function Modeling & CI',
    description: 'Population model $h(t) = \\frac{3000}{t+1}$: evaluation, transformations, and confidence intervals.',
    prerequisites: ['mm24e1-transformations', 'mm24e1-binomial-calculations'],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_3,
    tier: 3,
    position: { x: 3, y: 4 },
    isExamQuestion: true,
    examRef: { examId: 'mm-2024-1', year: 2024, subject: Subject.METHODS, questionNumber: 'Q5', marks: 6 },
    questions: [
      {
        id: 'mm24e1-eq-5',
        text: "$h(t) = \\frac{3000}{t+1}$ models population.\na. Predict population after 4 years.\nb. $h_1$ has $h_1(0) = h(0)$ but decreases at half the rate. State two transformations mapping $h$ to $h_1$.\nc.i. Find 95% CI for proportion unhappy ($\\hat{p}=0.6, n=100, z=2$).\nc.ii. Find smallest $n$ for $\\text{SD}(\\hat{P}) = \\frac{\\sqrt{2}}{50}$ with same $\\hat{p}$.",
        hints: ['a. $h(4) = 3000/5$', 'b. $h_1(t) = 0.5h(t) + 1500$', 'c.ii. $\\sqrt{0.24/n} = \\sqrt{2}/50$'],
        answer: 'a. 600. b. Dilation factor 0.5 from t-axis, translation +1500. c.i. $(0.5, 0.7)$. c.ii. $n = 300$.',
        markingGuide: ['Correct evaluation', 'Both transformations', 'Correct CI', 'Correct sample size'],
        marks: 6,
      },
    ],
  },
  {
    id: 'mm24e1-exam-q6',
    title: 'Q6: Logarithmic Equation',
    description: 'Solve $2\\log_3(x-4) + \\log_3(x) = 2$.',
    prerequisites: ['mm24e1-log-cubics'],
    topic: Topic.FUNCTIONS,
    difficulty: Difficulty.STAR_4,
    tier: 3,
    position: { x: 11, y: 3 },
    isExamQuestion: true,
    examRef: { examId: 'mm-2024-1', year: 2024, subject: Subject.METHODS, questionNumber: 'Q6', marks: 4 },
    questions: [
      {
        id: 'mm24e1-eq-6',
        text: 'Solve $2\\log_3(x-4) + \\log_3(x) = 2$ for $x$.',
        hints: ['Combine: $\\log_3(x(x-4)^2) = 2$', 'Cubic: $x^3 - 8x^2 + 16x - 9 = 0$', 'Factor theorem: test $x = 1$'],
        answer: '$x = \\frac{7 + \\sqrt{13}}{2}$ (only valid solution with $x > 4$).',
        markingGuide: ['Log combination', 'Correct cubic', 'Factor with $(x-1)$', 'Quadratic formula', 'Domain check'],
        marks: 4,
      },
    ],
  },
  {
    id: 'mm24e1-exam-q7',
    title: 'Q7: Trapezium Rule & Function Analysis',
    description: '$f(x) = x\\sin(x)$: trapezium approximation, derivative analysis, sketching $f\'(x)$.',
    prerequisites: ['mm24e1-function-analysis', 'mm24e1-area-under-curve'],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_4,
    tier: 3,
    position: { x: 6, y: 4 },
    isExamQuestion: true,
    examRef: { examId: 'mm-2024-1', year: 2024, subject: Subject.METHODS, questionNumber: 'Q7', marks: 9 },
    questions: [
      {
        id: 'mm24e1-eq-7',
        text: "$f(x) = x\\sin(x)$.\na. Trapezium rule with step $\\frac{\\pi}{3}$ over $[0, \\pi]$.\nb.i. Find $f'(x)$.\nb.ii. Range of $f'$ on $[\\frac{\\pi}{2}, \\frac{2\\pi}{3}]$.\nb.iii. Verify stationary point in $[\\frac{\\pi}{2}, \\frac{2\\pi}{3}]$.\nc. Sketch $y = f'(x)$ on $[-\\pi, \\pi]$.",
        hints: ['a. Evaluate $y$ at $0, \\pi/3, 2\\pi/3, \\pi$', "b. $f'(x) = \\sin(x) + x\\cos(x)$", "c. $f'(-\\pi) = \\pi$, $f'(\\pi) = -\\pi$"],
        answer: "a. $\\frac{\\pi^2\\sqrt{3}}{6}$. b.i. $\\sin(x) + x\\cos(x)$. b.iii. IVT: sign change. c. Endpoints $(-\\pi, \\pi)$ and $(\\pi, -\\pi)$.",
        markingGuide: ['Trapezium calculation', 'Product rule derivative', 'Range of derivative', 'IVT argument', 'Sketch with correct endpoints'],
        marks: 9,
      },
    ],
  },
  {
    id: 'mm24e1-exam-q8',
    title: 'Q8: Cube Root Function Analysis',
    description: '$g(x) = \\sqrt[3]{x-k} + m$: intercepts, gradients, equal gradient points.',
    prerequisites: ['mm24e1-cube-root-analysis'],
    topic: Topic.CALCULUS,
    difficulty: Difficulty.STAR_4,
    tier: 4,
    position: { x: 10, y: 4 },
    isExamQuestion: true,
    examRef: { examId: 'mm-2024-1', year: 2024, subject: Subject.METHODS, questionNumber: 'Q8', marks: 7 },
    questions: [
      {
        id: 'mm24e1-eq-8',
        text: "Let $g(x) = \\sqrt[3]{x-k} + m$, $k \\ne 0$. $P$ is the y-intercept.\na. Find coordinates of $P$ in terms of $k, m$.\nb. Find gradient at $P$ in terms of $k$.\nc. If $g$ passes through the origin, express $k$ in terms of $m$.\nd. Find point $Q \\ne P$ where gradient equals gradient at $P$, in terms of $m$.",
        hints: ['a. Set $x = 0$: $P = (0, \\sqrt[3]{-k} + m)$', "b. $g'(x) = \\frac{1}{3}(x-k)^{-2/3}$", 'c. $m = k^{1/3}$ so $k = m^3$', 'd. $(x-k)^2 = k^2$ gives $x = 2k$'],
        answer: 'a. $(0, m - k^{1/3})$. b. $\\frac{1}{3k^{2/3}}$. c. $k = m^3$. d. $Q = (2m^3, 2m)$.',
        markingGuide: ['y-intercept calculation', 'Derivative evaluation', 'Express k in terms of m', 'Equal gradient equation', 'Coordinates of Q'],
        marks: 7,
      },
    ],
  },
];

export const MM_2024_EXAM1_TREE: SkillTreeData = {
  id: 'mm-2024-exam1',
  title: 'Methods 2024 Exam 1',
  description: 'VCE Mathematical Methods 2024 — Exam 1 (Technology Free)',
  subject: Subject.METHODS,
  year: 2024,
  nodes,
  totalMarks: 40,
};
